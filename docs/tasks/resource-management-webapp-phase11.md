# Phase 11: エクスポート/インポートUI、統合テスト

## フェーズ概要

**要件名**: resource-management-webapp  
**期間**: 3日（24時間）  
**目標**: エクスポート/インポートUIと統合テストの実装  
**成果物**: 
- エクスポート/インポート画面実装完了
- 統合テスト実装完了
- E2Eテスト実装完了
- 動作確認完了

**関連要件**: WRREQ-043, WRREQ-044, WRREQ-045, WRREQ-046, WRREQ-047, WRREQ-055, WRREQ-057, WREDGE-002, WREDGE-003, WRNFR-012, WRNFR-013, WRNFR-014

### タスク統計

- **総タスク数**: 11タスク
- **推定作業時間**: 40時間
- **DIRECTタスク**: 0タスク
- **TDDタスク**: 11タスク

### クリティカルパス

**クリティカルパス**: TASK-0210 → TASK-0211 → TASK-0212 → TASK-0214 → TASK-0215 → TASK-0216 → TASK-0217 → TASK-0219

---

## 実行順序（ガントチャート）

```mermaid
gantt
    title Phase 1: エクスポート/インポートUI、統合テスト 実行順序
    dateFormat YYYY-MM-DD
    section Day 1
    TASK-101: タスク1 :2025-02-01, 2h
    section Day 2
    TASK-102: タスク2 :2025-02-02, 2h
```

---

## タスクプロセス定義

### TDDタスクの実行プロセス

TDDタスクは以下の6ステップで実行します：

1. `/tsumiki:tdd-requirements` - 詳細要件定義
2. `/tsumiki:tdd-testcases` - テストケース作成
3. `/tsumiki:tdd-red` - テスト実装（失敗）
4. `/tsumiki:tdd-green` - 最小実装
5. `/tsumiki:tdd-refactor` - リファクタリング
6. `/tsumiki:tdd-verify-complete` - 品質確認

### DIRECTタスクの実行プロセス

DIRECTタスクは以下の2ステップで実行します：

1. `/tsumiki:direct-setup` - 直接実装・設定
2. `/tsumiki:direct-verify` - 動作確認・品質確認

---

## 週次計画

### Day 1（8時間）
- **目標**: エクスポート/インポート画面実装
- **成果物**: 
  - エクスポート画面実装
  - インポート画面実装
  - バリデーション実装

### Day 2（8時間）
- **目標**: 統合テスト実装
- **成果物**: 
  - バックエンド統合テスト実装
  - フロントエンド統合テスト実装
  - API統合テスト実装

### Day 3（8時間）
- **目標**: E2Eテスト実装と動作確認
- **成果物**: 
  - E2Eテスト実装
  - 動作確認完了
  - ドキュメント作成完了

---

## 日次タスク

### Day 1: エクスポート/インポート画面実装

#### TASK-0210: エクスポート/インポート画面コンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-043, WRREQ-044, WRREQ-053, WRREQ-054
- **依存タスク**: TASK-0138, TASK-0142
- **実装詳細**:
  - `src/pages/import-export/ImportExportPage.tsx`を作成
  - エクスポートセクションを実装
  - インポートセクションを実装
  - レイアウトコンポーネントを使用
- **単体テスト要件**: 
  - エクスポート/インポート画面が正しく表示されることを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
  - パンくずリストで現在位置表示（WRREQ-054）
- **完了条件**: 
  - エクスポート/インポート画面コンポーネントが完成していること

#### TASK-0211: エクスポート機能実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-043, WRREQ-057
- **依存タスク**: TASK-0210, TASK-0143
- **実装詳細**:
  - エクスポート対象リソース選択UIを実装（チェックボックス）
  - エクスポートボタンを実装
  - エクスポートAPIを呼び出し
  - JSONファイルダウンロード処理を実装
  - 成功時にToast通知を表示
  - エラー時にエラーメッセージを表示
- **単体テスト要件**: 
  - エクスポート機能が正しく動作することを確認
- **UI/UX要件**: 
  - 操作成功時にトースト通知表示（WRREQ-057）
- **完了条件**: 
  - エクスポート機能が完成していること

#### TASK-0212: インポート機能実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 3時間
- **要件**: WRREQ-044, WRREQ-046, WRREQ-047, WRREQ-055, WRREQ-057, WREDGE-002, WREDGE-003
- **依存タスク**: TASK-0210, TASK-0143
- **実装詳細**:
  - ファイル選択UIを実装
  - ファイルサイズ制限チェックを実装（10MB）
  - インポートボタンを実装
  - インポートAPIを呼び出し（multipart/form-data）
  - バリデーション結果表示エリアを実装
  - 詳細なエラーメッセージを表示
  - 成功時にToast通知を表示
  - インポート結果を表示
- **単体テスト要件**: 
  - インポート機能が正しく動作することを確認
  - ファイルサイズ制限が正しく動作することを確認
  - バリデーションエラーが正しく表示されることを確認
- **UI/UX要件**: 
  - フォームバリデーションエラーを分かりやすく表示（WRREQ-055）
  - 操作成功時にトースト通知表示（WRREQ-057）
- **完了条件**: 
  - インポート機能が完成していること

#### TASK-0213: エクスポート/インポート画面テスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 0.5時間
- **要件**: WRNFR-012
- **依存タスク**: TASK-0211, TASK-0212
- **実装詳細**:
  - `src/pages/import-export/__tests__/ImportExportPage.test.tsx`を作成
  - エクスポート機能のテストを実装
  - インポート機能のテストを実装
  - エラーケースのテストを実装
- **単体テスト要件**: 
  - すべてのテストがパスすることを確認
- **完了条件**: 
  - エクスポート/インポート画面のテストが完成していること

---

### Day 2: 統合テスト実装

#### TASK-0214: バックエンド統合テスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRNFR-013
- **依存タスク**: TASK-0074, TASK-0096, TASK-0114, TASK-0126
- **実装詳細**:
  - 各APIエンドポイントの統合テストを実装
  - データベースを使用した統合テストを実装
  - エラーハンドリングの統合テストを実装
  - トランザクション処理の統合テストを実装
- **統合テスト要件**: 
  - すべての統合テストがパスすることを確認
- **完了条件**: 
  - バックエンド統合テストが完成していること

#### TASK-0215: フロントエンド統合テスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRNFR-013
- **依存タスク**: TASK-0149, TASK-0168, TASK-0189, TASK-0206
- **実装詳細**:
  - 各画面の統合テストを実装
  - APIクライアントとの統合テストを実装
  - TanStack Queryとの統合テストを実装
  - エラーハンドリングの統合テストを実装
- **統合テスト要件**: 
  - すべての統合テストがパスすることを確認
- **完了条件**: 
  - フロントエンド統合テストが完成していること

#### TASK-0216: API統合テスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 3時間
- **要件**: WRNFR-013
- **依存タスク**: TASK-0214, TASK-0215
- **実装詳細**:
  - フロントエンドとバックエンドの統合テストを実装
  - エンドツーエンドのAPI呼び出しテストを実装
  - エラーハンドリングの統合テストを実装
  - パフォーマンステストを実装
- **統合テスト要件**: 
  - すべての統合テストがパスすることを確認
- **完了条件**: 
  - API統合テストが完成していること

---

### Day 3: E2Eテスト実装と動作確認

#### TASK-0217: E2Eテスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 3時間
- **要件**: WRNFR-014
- **依存タスク**: TASK-0169, TASK-0190, TASK-0207
- **実装詳細**:
  - Playwrightを使用してE2Eテストを実装
  - 主要なユーザーフローのテストを実装
  - カード管理のE2Eテストを実装
  - 顧客管理のE2Eテストを実装
  - 錬金スタイル管理のE2Eテストを実装
  - エクスポート/インポートのE2Eテストを実装
  - エラーハンドリングのE2Eテストを実装
- **E2Eテスト要件**: 
  - すべてのE2Eテストがパスすることを確認
- **完了条件**: 
  - E2Eテストが完成していること

#### TASK-0218: パフォーマンステスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRNFR-001, WRNFR-002, WRNFR-003
- **依存タスク**: TASK-0170, TASK-0191, TASK-0208
- **実装詳細**:
  - 全体的なパフォーマンステストを実装
  - 各画面の初期表示時間を測定
  - 検索・フィルタリングの応答時間を測定
  - 1000件以上のデータでのテストを実施
  - パフォーマンスレポートを作成
- **完了条件**: 
  - パフォーマンステストが完成していること
  - パフォーマンス要件を満たしていること

#### TASK-0219: 動作確認と最終調整
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: DIRECT
- **推定工数**: 2時間
- **要件**: なし（一般的な開発プロセス）
- **依存タスク**: TASK-0217, TASK-0218
- **実装詳細**:
  - すべての機能の動作確認を実施
  - レスポンシブデザインの確認を実施
  - アクセシビリティの確認を実施
  - セキュリティの確認を実施
  - 最終的な調整とバグ修正
- **完了条件**: 
  - すべての機能が正常に動作すること

#### TASK-0220: ドキュメント作成
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: DIRECT
- **推定工数**: 1時間
- **要件**: なし（一般的な開発プロセス）
- **依存タスク**: TASK-0219
- **実装詳細**:
  - プロジェクト全体のドキュメントを作成
  - セットアップ手順を記載
  - 開発ガイドラインを記載
  - APIドキュメントを整理
  - テストドキュメントを整理
- **完了条件**: 
  - ドキュメントが完成していること

---

## フェーズ完了条件

- [ ] エクスポート/インポート画面が実装されていること
- [ ] 統合テストが実装されていること
- [ ] E2Eテストが実装されていること
- [ ] すべてのテストがパスしていること
- [ ] パフォーマンス要件を満たしていること
- [ ] ドキュメントが完成していること

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-01-XX | 1.0 | 初版作成 |

