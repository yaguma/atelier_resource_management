# Phase 3-B: カード管理画面

## フェーズ概要

### 要件名
resource-management-webapp

### 期間・目標
- **期間**: 5営業日（Week 5、Day 24-28）
- **総工数**: 40時間
- **タスク数**: 5タスク
- **目標**: カード管理画面（一覧・作成・編集・詳細・削除）を実装する

### 成果物
- カード一覧画面（ページネーション、検索、フィルタリング）
- カード作成画面（フォーム、バリデーション）
- カード編集画面（既存データ取得、更新）
- カード詳細画面（読み取り専用表示）
- カード削除機能（モーダル確認、削除実行）

---

## 週次計画

### Week 5（Day 24-28）: カード管理画面実装
**目標**: カード管理の全画面（一覧・作成・編集・詳細・削除）を実装する

**成果物**:
- カード一覧画面（ページネーション、検索、フィルタリング）
- カード作成画面（フォーム、バリデーション）
- カード編集画面（既存データ取得、更新）
- カード詳細画面（読み取り専用表示）
- カード削除機能（モーダル確認、削除実行）

---

## 日次タスク

### Day 24（8時間）: カード一覧画面

#### ☑ TASK-0038: カード一覧画面実装
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件へのリンク**: WRREQ-053, WRREQ-053-1, WRREQ-053-2
- **依存タスク**: TASK-0029, TASK-0030, TASK-0035, TASK-0036, TASK-0037

**実装詳細**:
1. `src/pages/cards/CardListPage.tsx`作成
   - `useCards`フックでカード一覧を取得（ページネーション、検索パラメータ付き）
   - テーブル形式でカード一覧を表示（名前、タイプ、レアリティ、操作列）
   - 検索入力フィールド（カード名で検索）
   - ページネーションコントロール（前へ/次へボタン、現在ページ表示）
   - 新規作成ボタン（/cards/new へリンク）
   - 各行に詳細・編集ボタン配置

**完了条件**: カード一覧表示、ページネーション動作、検索機能動作、新規作成・詳細・編集ボタンが正しく動作する

**テスト要件**: データ取得時の表示、検索フィルタリング、ページ切り替えの動作確認

---

### Day 25（8時間）: カード作成画面

#### ☑ TASK-0039: カード作成画面実装
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件へのリンク**: WRREQ-053, WRREQ-053-3
- **依存タスク**: TASK-0029, TASK-0030, TASK-0031, TASK-0032, TASK-0034

**実装詳細**:
1. `src/pages/cards/CardCreatePage.tsx`作成
   - react-hook-formとZodスキーマでフォーム管理
   - 入力フィールド: カード名、説明、カードタイプ（select）、レアリティ（select）、安定性値、エネルギーコスト
   - `useCreateCard`フックで作成API呼び出し
   - 成功時: Toast通知表示、一覧画面へ遷移
   - エラー時: Toast通知表示、バリデーションエラー表示
   - 作成・キャンセルボタン配置

**完了条件**: フォーム表示、バリデーション動作、作成成功時のToast通知と画面遷移

**テスト要件**: フォーム送信でのAPI呼び出し、バリデーションエラー表示、作成成功時のToast通知

---

### Day 26（8時間）: カード編集画面

#### ☑ TASK-0040: カード編集画面実装
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件へのリンク**: WRREQ-053, WRREQ-053-4
- **依存タスク**: TASK-0039

**実装詳細**:
1. `src/pages/cards/CardEditPage.tsx`作成
   - `useParams`でカードIDを取得
   - `useCard`フックで既存カードデータを取得
   - `useEffect`でフォームに既存データを設定（`reset`）
   - フォーム構成はCardCreatePageと同様
   - `useUpdateCard`フックで更新API呼び出し
   - 成功時: Toast通知表示、一覧画面へ遷移
   - エラー時: Toast通知表示

**完了条件**: 既存データ取得、フォーム初期化、更新成功時のToast通知と画面遷移

**テスト要件**: 既存データでのフォーム初期化、フォーム送信での更新API呼び出し、更新成功時のToast通知

---

### Day 27（8時間）: カード詳細画面

#### ☑ TASK-0041: カード詳細画面実装
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件へのリンク**: WRREQ-053, WRREQ-053-5
- **依存タスク**: TASK-0029, TASK-0030

**実装詳細**:
1. `src/pages/cards/CardDetailPage.tsx`作成
   - `useParams`でカードIDを取得
   - `useCard`フックでカードデータを取得
   - 読み取り専用でカード情報を表示: カード名、説明、カードタイプ、レアリティ、安定性値、エネルギーコスト
   - 編集ボタン（/cards/:id/edit へリンク）
   - 一覧に戻るボタン（/cards へリンク）
   - ローディング・エラー・データ未存在時の処理

**完了条件**: カード詳細表示、全フィールド正しく表示、編集・一覧戻るボタンが動作

**テスト要件**: データ取得時の詳細表示、存在しないIDでのエラーメッセージ表示

---

### Day 28（8時間）: カード削除機能

#### ☑ TASK-0042: カード削除機能実装
- **推定工数**: 8時間
- **タスクタイプ**: TDD
- **要件へのリンク**: WRREQ-053, WRREQ-053-6
- **依存タスク**: TASK-0033, TASK-0034, TASK-0041

**実装詳細**:
1. `src/hooks/useCards.ts`に削除機能追加
   - `useDeleteCard`フックを実装（useMutation使用）
   - 成功時にクエリキャッシュを無効化

2. `src/pages/cards/CardDetailPage.tsx`に削除ボタン追加
   - 削除ボタン配置（danger variant）
   - 削除確認モーダル実装（Modal コンポーネント使用）
   - `useDeleteCard`フックで削除API呼び出し
   - 成功時: Toast通知表示、一覧画面へ遷移
   - エラー時: Toast通知表示
   - モーダル内にキャンセル・削除ボタン配置

**完了条件**: 削除ボタン表示、削除確認モーダル表示、削除成功時のToast通知と画面遷移

**テスト要件**: 削除ボタンクリックでのモーダル表示、モーダル内削除ボタンでの削除API呼び出し、削除成功時のToast通知、キャンセルボタンでのモーダルクローズ

---

## Phase 3-B 完了条件

**必須条件**: カード一覧・作成・編集・詳細・削除の全画面が動作する

**品質基準**: ESLint・Prettier整形済み、TypeScriptコンパイルエラーなし、全テスト通過、Toast通知・ページネーション・フォームバリデーション正常動作

**マイルストーン**: M3-B（カード管理画面完成）、M3（フロントエンド基盤・カード管理画面完成）

---

## Phase 3 完了条件

**必須条件**: React Router・TanStack Query・Axios設定完了、Zodバリデーションスキーマ実装、共通コンポーネント（Button、Modal、Toast）実装、レイアウトコンポーネント（Sidebar、Header、Breadcrumbs）実装、カード一覧・作成・編集・詳細・削除の全画面が動作する

**品質基準**: ESLint・Prettier整形済み、TypeScriptコンパイルエラーなし、全テスト通過、TanStack Query Devtoolsで状態確認可能、Toast通知・ページネーション・フォームバリデーション正常動作

**マイルストーン**: M3（フロントエンド基盤・カード管理画面完成）- Phase 3完了時点で達成

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-11-09 | 1.0 | 初版作成。5タスク、32時間 |
| 2025-11-09 | 1.1 | Phase 3を3-Aと3-Bに分割。Day 27-30、4営業日 |
| 2025-11-09 | 1.2 | 簡潔化（555行→182行、373行削減）。コード例削除、実装詳細・完了条件・テスト要件を簡潔化 |
