# Phase 7: フロントエンド基盤

## フェーズ概要

**要件名**: resource-management-webapp  
**期間**: 5日（40時間）  
**目標**: フロントエンド基盤の実装（ルーティング、レイアウト、共通コンポーネント、APIクライアント）  
**成果物**: 
- React Router設定完了
- TanStack Query設定完了
- Axios設定完了
- 共通レイアウトコンポーネント実装完了
- 共通UIコンポーネント実装完了
- APIクライアント実装完了

**関連要件**: WRREQ-001-3, WRREQ-001-4, WRREQ-001-5, WRREQ-001-6, WRREQ-005, WRREQ-006, WRREQ-053, WRREQ-054, WRREQ-055

### タスク統計

- **総タスク数**: 21タスク
- **推定作業時間**: 40時間
- **DIRECTタスク**: 0タスク
- **TDDタスク**: 21タスク

### クリティカルパス

**クリティカルパス**: TASK-0130 → TASK-0131 → TASK-0132 → TASK-0135 → TASK-0136 → TASK-0138 → TASK-0139 → TASK-0140 → TASK-0141 → TASK-0143 → TASK-0144 → TASK-0149

---

## 実行順序（ガントチャート）

```mermaid
gantt
    title Phase 7: フロントエンド基盤 実行順序
    dateFormat YYYY-MM-DD
    section Day 1
    TASK-701: タスク1 :2025-02-01, 2h
    section Day 2
    TASK-702: タスク2 :2025-02-02, 2h
```

---

## タスクプロセス定義

### TDDタスクの実行プロセス

TDDタスクは以下の6ステップで実行します：

1. `/tsumiki:tdd-requirements` - 詳細要件定義
2. `/tsumiki:tdd-testcases` - テストケース作成
3. `/tsumiki:tdd-red` - テスト実装（失敗）
4. `/tsumiki:tdd-green` - 最小実装
5. `/tsumiki:tdd-refactor` - リファクタリング
6. `/tsumiki:tdd-verify-complete` - 品質確認

### DIRECTタスクの実行プロセス

DIRECTタスクは以下の2ステップで実行します：

1. `/tsumiki:direct-setup` - 直接実装・設定
2. `/tsumiki:direct-verify` - 動作確認・品質確認

---

## 週次計画

### Day 1（8時間）
- **目標**: React Router・TanStack Query・Axios設定
- **成果物**: 
  - React Router設定完了
  - TanStack Query設定完了
  - Axios設定完了

### Day 2（8時間）
- **目標**: 共通レイアウトコンポーネント実装
- **成果物**: 
  - Headerコンポーネント実装
  - Sidebarコンポーネント実装
  - Layoutコンポーネント実装
  - パンくずリストコンポーネント実装

### Day 3（8時間）
- **目標**: 共通UIコンポーネント実装
- **成果物**: 
  - Buttonコンポーネント実装
  - Inputコンポーネント実装
  - Tableコンポーネント実装
  - Formコンポーネント実装

### Day 4（8時間）
- **目標**: APIクライアント実装
- **成果物**: 
  - APIクライアントラッパー実装
  - TanStack Queryフック実装
  - エラーハンドリング実装

### Day 5（8時間）
- **目標**: 動作確認とドキュメント作成
- **成果物**: 
  - 動作確認完了
  - ドキュメント作成完了

---

## 日次タスク

### Day 1: React Router・TanStack Query・Axios設定

#### TASK-0130: React Router詳細設定
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-001-3
- **依存タスク**: TASK-0029
- **実装詳細**:
  - ルート定義を詳細化（`src/routes/index.tsx`）
  - 各画面のルートを定義
  - 404ページを実装
  - リダイレクト処理を実装
- **単体テスト要件**: 
  - ルーティングが正しく動作することを確認
- **完了条件**: 
  - React Routerが詳細に設定されていること

#### TASK-0131: TanStack Query詳細設定
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-001-4
- **依存タスク**: TASK-0030
- **実装詳細**:
  - QueryClientの設定を詳細化
  - キャッシュ戦略を設定（staleTime: 5分、cacheTime: 10分）
  - リトライ戦略を設定
  - エラーハンドリングを設定
  - グローバルエラーハンドラーを実装
- **単体テスト要件**: 
  - QueryClientが正しく設定されていることを確認
- **完了条件**: 
  - TanStack Queryが詳細に設定されていること

#### TASK-0132: Axios詳細設定
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-001-6
- **依存タスク**: TASK-0031
- **実装詳細**:
  - Axiosインスタンスの設定を詳細化
  - リクエストインターセプターを実装（認証トークン追加等）
  - レスポンスインターセプターを実装（エラーハンドリング、リトライ）
  - エラーレスポンスの変換処理を実装
- **単体テスト要件**: 
  - Axios設定が正しく動作することを確認
  - インターセプターが正しく動作することを確認
- **完了条件**: 
  - Axiosが詳細に設定されていること

#### TASK-0133: 環境変数設定
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: DIRECT
- **推定工数**: 1時間
- **要件**: WRREQ-007
- **依存タスク**: TASK-0005
- **実装詳細**:
  - フロントエンド用の環境変数を設定
  - APIベースURLを環境変数から読み込む
  - 開発環境・本番環境の設定を分離
- **完了条件**: 
  - 環境変数が正しく設定されていること

#### TASK-0134: 型定義ファイル整理
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: DIRECT
- **推定工数**: 1時間
- **要件**: WRREQ-002
- **依存タスク**: TASK-0017, TASK-0018, TASK-0019, TASK-0020
- **実装詳細**:
  - フロントエンド用の型定義ファイルを整理
  - バックエンドの型定義をフロントエンドでも使用可能にする
  - 型定義のエクスポートを整理
- **完了条件**: 
  - 型定義ファイルが整理されていること

---

### Day 2: 共通レイアウトコンポーネント実装

#### TASK-0135: Headerコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: WRREQ-053
- **依存タスク**: TASK-0003, TASK-0032
- **実装詳細**:
  - `src/components/layout/Header.tsx`を実装
  - アプリタイトルを表示
  - ナビゲーションメニューを実装
  - レスポンシブ対応（モバイル時はハンバーガーメニュー）
- **単体テスト要件**: 
  - Headerコンポーネントが正しく表示されることを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
- **完了条件**: 
  - Headerコンポーネントが完成していること

#### TASK-0136: Sidebarコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-053
- **依存タスク**: TASK-0003, TASK-0032, TASK-0130
- **実装詳細**:
  - `src/components/layout/Sidebar.tsx`を実装
  - 左サイドバーでナビゲーションを提供
  - メニュー項目を実装（ホーム、カード管理、顧客管理、錬金スタイル管理、データ管理）
  - アクティブ状態の表示
  - レスポンシブ対応（モバイル時は折りたたみ可能）
- **単体テスト要件**: 
  - Sidebarコンポーネントが正しく表示されることを確認
  - ナビゲーションが正しく動作することを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
  - 左サイドバーでナビゲーション提供（WRREQ-053）
- **完了条件**: 
  - Sidebarコンポーネントが完成していること

#### TASK-0137: パンくずリストコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: WRREQ-054
- **依存タスク**: TASK-0003, TASK-0130
- **実装詳細**:
  - `src/components/common/Breadcrumb.tsx`を実装
  - 現在位置を表示
  - ルート情報から自動生成
  - クリック可能なリンクを実装
- **単体テスト要件**: 
  - パンくずリストコンポーネントが正しく表示されることを確認
- **UI/UX要件**: 
  - パンくずリストで現在位置表示（WRREQ-054）
- **完了条件**: 
  - パンくずリストコンポーネントが完成していること

#### TASK-0138: Layoutコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-053, WRREQ-054
- **依存タスク**: TASK-0135, TASK-0136, TASK-0137
- **実装詳細**:
  - `src/components/layout/Layout.tsx`を実装
  - Header、Sidebar、Breadcrumbを統合
  - メインコンテンツエリアを実装
  - レスポンシブ対応
- **単体テスト要件**: 
  - Layoutコンポーネントが正しく表示されることを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
- **完了条件**: 
  - Layoutコンポーネントが完成していること

---

### Day 3: 共通UIコンポーネント実装

#### TASK-0139: Buttonコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: なし（一般的なUI要件）
- **依存タスク**: TASK-0003
- **実装詳細**:
  - `src/components/common/Button.tsx`を実装
  - バリアント（primary, secondary, danger等）を実装
  - サイズ（sm, md, lg）を実装
  - ローディング状態を実装
  - 無効化状態を実装
- **単体テスト要件**: 
  - Buttonコンポーネントが正しく表示されることを確認
- **完了条件**: 
  - Buttonコンポーネントが完成していること

#### TASK-0140: Inputコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-055
- **依存タスク**: TASK-0003
- **実装詳細**:
  - `src/components/common/Input.tsx`を実装
  - テキスト入力、数値入力、日付入力等を実装
  - エラー表示機能を実装
  - ラベル表示機能を実装
  - プレースホルダー機能を実装
- **単体テスト要件**: 
  - Inputコンポーネントが正しく表示されることを確認
  - エラー表示が正しく動作することを確認
- **UI/UX要件**: 
  - フォームバリデーションエラーを分かりやすく表示（WRREQ-055）
- **完了条件**: 
  - Inputコンポーネントが完成していること

#### TASK-0141: Tableコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-016, WRREQ-025
- **依存タスク**: TASK-0003
- **実装詳細**:
  - `src/components/common/Table.tsx`を実装
  - テーブル表示機能を実装
  - ソート機能を実装
  - ページネーション機能を実装
  - レスポンシブ対応（モバイル時はカード形式）
- **単体テスト要件**: 
  - Tableコンポーネントが正しく表示されることを確認
  - ソート機能が正しく動作することを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
- **完了条件**: 
  - Tableコンポーネントが完成していること

#### TASK-0142: Formコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-001-5, WRREQ-055
- **依存タスク**: TASK-0003, TASK-0139, TASK-0140
- **実装詳細**:
  - `src/components/common/Form.tsx`を実装
  - React Hook Formと統合
  - Zodバリデーションと統合
  - エラー表示機能を実装
  - 送信ボタン、キャンセルボタンを実装
- **単体テスト要件**: 
  - Formコンポーネントが正しく動作することを確認
  - バリデーションが正しく動作することを確認
- **UI/UX要件**: 
  - フォームバリデーションエラーを分かりやすく表示（WRREQ-055）
- **完了条件**: 
  - Formコンポーネントが完成していること

---

### Day 4: APIクライアント実装

#### TASK-0143: APIクライアントラッパー実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-001-6
- **依存タスク**: TASK-0132
- **実装詳細**:
  - `src/services/api-client.ts`を作成
  - 各APIエンドポイントのラッパー関数を実装
  - 型安全なAPI呼び出しを実装
  - エラーハンドリングを実装
- **単体テスト要件**: 
  - APIクライアントが正しく動作することを確認
- **完了条件**: 
  - APIクライアントラッパーが完成していること

#### TASK-0144: TanStack Queryフック実装（カード管理）
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-001-4
- **依存タスク**: TASK-0131, TASK-0143
- **実装詳細**:
  - `src/hooks/queries/useCards.ts`を作成
  - `useQuery`でカード一覧取得フックを実装
  - `useQuery`でカード詳細取得フックを実装
  - `useMutation`でカード作成フックを実装
  - `useMutation`でカード更新フックを実装
  - `useMutation`でカード削除フックを実装
- **単体テスト要件**: 
  - 各フックが正しく動作することを確認
- **完了条件**: 
  - カード管理用のTanStack Queryフックが完成していること

#### TASK-0145: TanStack Queryフック実装（顧客管理）
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-001-4
- **依存タスク**: TASK-0131, TASK-0143
- **実装詳細**:
  - `src/hooks/queries/useCustomers.ts`を作成
  - `useQuery`で顧客一覧取得フックを実装
  - `useQuery`で顧客詳細取得フックを実装
  - `useMutation`で顧客作成フックを実装
  - `useMutation`で顧客更新フックを実装
  - `useMutation`で顧客削除フックを実装
- **単体テスト要件**: 
  - 各フックが正しく動作することを確認
- **完了条件**: 
  - 顧客管理用のTanStack Queryフックが完成していること

#### TASK-0146: エラーハンドリングコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: WRREQ-055
- **依存タスク**: TASK-0003, TASK-0033
- **実装詳細**:
  - `src/components/common/ErrorBoundary.tsx`を強化
  - `src/components/common/ErrorMessage.tsx`を強化
  - Toast通知コンポーネントを実装
  - エラー表示の統一化
- **単体テスト要件**: 
  - エラーハンドリングコンポーネントが正しく動作することを確認
- **UI/UX要件**: 
  - フォームバリデーションエラーを分かりやすく表示（WRREQ-055）
- **完了条件**: 
  - エラーハンドリングコンポーネントが完成していること

---

### Day 5: 動作確認とドキュメント作成

#### TASK-0147: ローディングコンポーネント強化
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1時間
- **要件**: なし（一般的なUI要件）
- **依存タスク**: TASK-0034
- **実装詳細**:
  - `src/components/common/Loading.tsx`を強化
  - スケルトンローダーを実装
  - 各種ローディング状態に対応
- **単体テスト要件**: 
  - ローディングコンポーネントが正しく表示されることを確認
- **完了条件**: 
  - ローディングコンポーネントが強化されていること

#### TASK-0148: 共通コンポーネントテスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRNFR-012
- **依存タスク**: TASK-0135, TASK-0136, TASK-0137, TASK-0138, TASK-0139, TASK-0140, TASK-0141, TASK-0142
- **実装詳細**:
  - 各共通コンポーネントのテストを実装
  - React Testing Libraryを使用
  - テストカバレッジ80%以上を目標
- **単体テスト要件**: 
  - すべてのテストがパスすることを確認
- **完了条件**: 
  - 共通コンポーネントのテストが完成していること

#### TASK-0149: 動作確認と統合テスト
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRNFR-013
- **依存タスク**: TASK-0143, TASK-0144, TASK-0145, TASK-0146
- **実装詳細**:
  - フロントエンドとバックエンドの統合テストを実施
  - 各APIエンドポイントとの連携を確認
  - エラーハンドリングの確認を実施
  - レスポンシブデザインの確認を実施
- **統合テスト要件**: 
  - すべての統合テストがパスすることを確認
- **完了条件**: 
  - 動作確認が完了していること

#### TASK-0150: ドキュメント作成
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: DIRECT
- **推定工数**: 2時間
- **要件**: なし（一般的な開発プロセス）
- **依存タスク**: TASK-0149
- **実装詳細**:
  - コンポーネントの使い方をドキュメント化
  - APIクライアントの使い方をドキュメント化
  - 開発ガイドラインを作成
- **完了条件**: 
  - ドキュメントが完成していること

---

## フェーズ完了条件

- [ ] React Routerが詳細に設定されていること
- [ ] TanStack Queryが詳細に設定されていること
- [ ] Axiosが詳細に設定されていること
- [ ] 共通レイアウトコンポーネントが実装されていること
- [ ] 共通UIコンポーネントが実装されていること
- [ ] APIクライアントが実装されていること
- [ ] すべてのテストがパスしていること

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-01-XX | 1.0 | 初版作成 |

