# Phase 10: 錬金スタイル管理UI、ダッシュボード

## フェーズ概要

**要件名**: resource-management-webapp  
**期間**: 5日（40時間）  
**目標**: 錬金スタイル管理UIとダッシュボード画面の実装  
**成果物**: 
- 錬金スタイル管理UI実装完了（一覧、作成、編集画面）
- ダッシュボード画面実装完了
- 統計情報表示実装完了
- バリデーション実装完了
- エラーハンドリング実装完了

**関連要件**: WRREQ-031, WRREQ-052, WRREQ-053, WRREQ-054, WRREQ-055, WRREQ-057

### タスク統計

- **総タスク数**: 17タスク
- **推定作業時間**: 40時間
- **DIRECTタスク**: 0タスク
- **TDDタスク**: 17タスク

### クリティカルパス

**クリティカルパス**: TASK-0193 → TASK-0194 → TASK-0195 → TASK-0196 → TASK-0197 → TASK-0199 → TASK-0200 → TASK-0201 → TASK-0202 → TASK-0203 → TASK-0204 → TASK-0207 → TASK-0209

---

## 実行順序（ガントチャート）

```mermaid
gantt
    title Phase 0: 錬金スタイル管理UI、ダッシュボード 実行順序
    dateFormat YYYY-MM-DD
    section Day 1
    TASK-1: タスク1 :2025-02-01, 2h
    section Day 2
    TASK-2: タスク2 :2025-02-02, 2h
```

---

## タスクプロセス定義

### TDDタスクの実行プロセス

TDDタスクは以下の6ステップで実行します：

1. `/tsumiki:tdd-requirements` - 詳細要件定義
2. `/tsumiki:tdd-testcases` - テストケース作成
3. `/tsumiki:tdd-red` - テスト実装（失敗）
4. `/tsumiki:tdd-green` - 最小実装
5. `/tsumiki:tdd-refactor` - リファクタリング
6. `/tsumiki:tdd-verify-complete` - 品質確認

### DIRECTタスクの実行プロセス

DIRECTタスクは以下の2ステップで実行します：

1. `/tsumiki:direct-setup` - 直接実装・設定
2. `/tsumiki:direct-verify` - 動作確認・品質確認

---

## 週次計画

### Day 1-2（16時間）
- **目標**: 錬金スタイル管理UI実装
- **成果物**: 
  - 錬金スタイル一覧画面実装
  - 錬金スタイル作成画面実装（N:Mリレーション処理含む）
  - 錬金スタイル編集画面実装（N:Mリレーション更新処理含む）

### Day 3（8時間）
- **目標**: ダッシュボード画面実装
- **成果物**: 
  - ダッシュボード画面実装
  - 統計情報表示実装

### Day 4（8時間）
- **目標**: 統計情報API実装
- **成果物**: 
  - 統計情報取得API実装
  - データ集計処理実装

### Day 5（8時間）
- **目標**: テスト実装と動作確認
- **成果物**: 
  - UIテスト実装
  - E2Eテスト実装
  - 動作確認とドキュメント作成

---

## 日次タスク

### Day 1-2: 錬金スタイル管理UI実装

#### TASK-0193: 錬金スタイル一覧画面コンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-031, WRREQ-053, WRREQ-054
- **依存タスク**: TASK-0138, TASK-0141
- **実装詳細**:
  - `src/pages/alchemy-styles/AlchemyStyleListPage.tsx`を作成
  - 錬金スタイル一覧を表示
  - Tableコンポーネントを使用
  - レイアウトコンポーネントを使用
- **単体テスト要件**: 
  - 錬金スタイル一覧画面が正しく表示されることを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
  - パンくずリストで現在位置表示（WRREQ-054）
- **完了条件**: 
  - 錬金スタイル一覧画面コンポーネントが完成していること

#### TASK-0194: 錬金スタイル作成画面コンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2時間
- **要件**: WRREQ-031, WRREQ-053, WRREQ-054
- **依存タスク**: TASK-0138, TASK-0142
- **実装詳細**:
  - `src/pages/alchemy-styles/AlchemyStyleCreatePage.tsx`を作成
  - 錬金スタイル作成フォームを実装
  - レイアウトコンポーネントを使用
- **単体テスト要件**: 
  - 錬金スタイル作成画面が正しく表示されることを確認
- **UI/UX要件**: 
  - パンくずリストで現在位置表示（WRREQ-054）
- **完了条件**: 
  - 錬金スタイル作成画面コンポーネントが完成していること

#### TASK-0195: 錬金スタイル作成フォーム実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 3時間
- **要件**: WRREQ-031, WRREQ-055
- **依存タスク**: TASK-0194, TASK-0140, TASK-0142
- **実装詳細**:
  - React Hook Formを使用
  - Zodバリデーションスキーマを実装
  - 各入力項目を実装（name, description, characteristics, iconUrl）
  - エラー表示を実装
  - 送信ボタン、キャンセルボタンを実装
- **単体テスト要件**: 
  - フォームが正しく動作することを確認
- **UI/UX要件**: 
  - フォームバリデーションエラーを分かりやすく表示（WRREQ-055）
- **完了条件**: 
  - 錬金スタイル作成フォームが完成していること

#### TASK-0196: N:Mリレーション処理実装（初期デッキカード選択）
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-030
- **依存タスク**: TASK-0195, TASK-0144
- **実装詳細**:
  - 初期デッキカード選択コンポーネントを実装
  - カード一覧を取得して表示
  - 複数選択可能なUIを実装
  - 選択したカードIDをフォームに設定
  - バリデーションを実装（存在チェック）
- **単体テスト要件**: 
  - N:Mリレーション処理が正しく動作することを確認
- **完了条件**: 
  - N:Mリレーション処理が完成していること

#### TASK-0197: 錬金スタイル作成処理実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: WRREQ-031, WRREQ-057
- **依存タスク**: TASK-0195, TASK-0196
- **実装詳細**:
  - TanStack QueryのuseMutationを使用
  - 錬金スタイル作成APIを呼び出し（initialDeckCardIdsを含む）
  - 成功時にToast通知を表示
  - 成功時に錬金スタイル一覧画面へ遷移
  - エラー時にエラーメッセージを表示
- **単体テスト要件**: 
  - 錬金スタイル作成処理が正しく動作することを確認
- **UI/UX要件**: 
  - 操作成功時にトースト通知表示（WRREQ-057）
- **完了条件**: 
  - 錬金スタイル作成処理が完成していること

#### TASK-0198: 錬金スタイル編集画面実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 4.5時間
- **要件**: WRREQ-031, WRREQ-055, WRREQ-057
- **依存タスク**: TASK-0193, TASK-0142
- **実装詳細**:
  - `src/pages/alchemy-styles/AlchemyStyleEditPage.tsx`を作成
  - 錬金スタイル編集フォームを実装
  - 既存データの読み込みを実装
  - N:Mリレーション更新処理を実装
  - 更新処理を実装
  - レイアウトコンポーネントを使用
- **単体テスト要件**: 
  - 錬金スタイル編集画面が正しく動作することを確認
- **UI/UX要件**: 
  - フォームバリデーションエラーを分かりやすく表示（WRREQ-055）
  - 操作成功時にトースト通知表示（WRREQ-057）
- **完了条件**: 
  - 錬金スタイル編集画面が完成していること

---

### Day 3: ダッシュボード画面実装

#### TASK-0199: ダッシュボード画面コンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-052, WRREQ-053, WRREQ-054
- **依存タスク**: TASK-0138
- **実装詳細**:
  - `src/pages/DashboardPage.tsx`を作成
  - ダッシュボード画面を実装
  - レイアウトコンポーネントを使用
  - 統計情報カードを配置
- **単体テスト要件**: 
  - ダッシュボード画面が正しく表示されることを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
  - パンくずリストで現在位置表示（WRREQ-054）
- **完了条件**: 
  - ダッシュボード画面コンポーネントが完成していること

#### TASK-0200: 統計情報カードコンポーネント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-052
- **依存タスク**: TASK-0199
- **実装詳細**:
  - `src/components/dashboard/StatCard.tsx`を作成
  - 統計情報カードコンポーネントを実装
  - アイコン、数値、前回比を表示
  - レスポンシブ対応（デスクトップ: 4列、タブレット: 2列、モバイル: 1列）
- **単体テスト要件**: 
  - 統計情報カードが正しく表示されることを確認
- **UI/UX要件**: 
  - レスポンシブデザイン対応（WRREQ-006）
- **完了条件**: 
  - 統計情報カードコンポーネントが完成していること

#### TASK-0201: 統計情報表示実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 3時間
- **要件**: WRREQ-052
- **依存タスク**: TASK-0200
- **実装詳細**:
  - 各リソースの総数を取得（TanStack Query）
  - 統計情報カードにデータを表示
  - ローディング状態を表示
  - エラーハンドリングを実装
- **単体テスト要件**: 
  - 統計情報が正しく表示されることを確認
- **完了条件**: 
  - 統計情報表示が完成していること

---

### Day 4: 統計情報API実装

#### TASK-0202: 統計情報Service実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-052
- **依存タスク**: TASK-0049, TASK-0051, TASK-0101, TASK-0106
- **実装詳細**:
  - `src/services/statistics-service.ts`を作成
  - 各リソースの総数を取得するメソッドを実装
  - データ集計処理を実装
  - 統計情報を返却
- **単体テスト要件**: 
  - Serviceが正しく動作することを確認
- **完了条件**: 
  - 統計情報Serviceが完成していること

#### TASK-0203: 統計情報APIエンドポイント実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRREQ-052, WRREQ-067
- **依存タスク**: TASK-0202, TASK-0028
- **実装詳細**:
  - `src/routes/statistics.ts`を作成
  - `GET /api/statistics`エンドポイントを実装
  - StatisticsServiceのgetStatisticsメソッドを呼び出し
  - レスポンス形式を整える
- **単体テスト要件**: 
  - エンドポイントが正しく動作することを確認
- **統合テスト要件**: 
  - Service層との統合テストを実施
- **完了条件**: 
  - 統計情報APIが完成していること

#### TASK-0204: TanStack Queryフック実装（統計情報）
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: WRREQ-001-4
- **依存タスク**: TASK-0203, TASK-0131
- **実装詳細**:
  - `src/hooks/queries/useStatistics.ts`を作成
  - `useQuery`で統計情報取得フックを実装
  - キャッシュ戦略を設定
- **単体テスト要件**: 
  - フックが正しく動作することを確認
- **完了条件**: 
  - 統計情報用のTanStack Queryフックが完成していること

#### TASK-0205: 統計情報APIテスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: WRNFR-012
- **依存タスク**: TASK-0203
- **実装詳細**:
  - `src/routes/__tests__/statistics.test.ts`を作成
  - 統計情報APIのテストを実装
  - エラーケースのテストを実装
- **単体テスト要件**: 
  - すべてのテストがパスすることを確認
- **完了条件**: 
  - 統計情報APIのテストが完成していること

---

### Day 5: テスト実装と動作確認

#### TASK-0206: UIテスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRNFR-012
- **依存タスク**: TASK-0193, TASK-0194, TASK-0198, TASK-0199
- **実装詳細**:
  - 各画面のテストを実装
  - React Testing Libraryを使用
  - ユーザーインタラクションのテストを実装
  - テストカバレッジ80%以上を目標
- **単体テスト要件**: 
  - すべてのテストがパスすることを確認
- **完了条件**: 
  - UIテストが完成していること

#### TASK-0207: E2Eテスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 2.5時間
- **要件**: WRNFR-014
- **依存タスク**: TASK-0206
- **実装詳細**:
  - Playwrightを使用してE2Eテストを実装
  - 錬金スタイル管理のテストを実装
  - ダッシュボードのテストを実装
- **E2Eテスト要件**: 
  - すべてのE2Eテストがパスすることを確認
- **完了条件**: 
  - E2Eテストが完成していること

#### TASK-0208: パフォーマンステスト実装
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: TDD
- **推定工数**: 1.5時間
- **要件**: WRNFR-001
- **依存タスク**: TASK-0199, TASK-0201
- **実装詳細**:
  - ダッシュボードの初期表示時間を測定（目標: 2秒以内）
  - パフォーマンステストを実装
- **完了条件**: 
  - パフォーマンステストが完成していること
  - パフォーマンス要件を満たしていること

#### TASK-0209: 動作確認とドキュメント作成
- [ ] **タスク完了**
- <!-- GitHub Issue: # -->
- **タスクタイプ**: DIRECT
- **推定工数**: 1.5時間
- **要件**: なし（一般的な開発プロセス）
- **依存タスク**: TASK-0206, TASK-0207, TASK-0208
- **実装詳細**:
  - すべての画面の動作確認を実施
  - レスポンシブデザインの確認を実施
  - アクセシビリティの確認を実施
  - ドキュメントを作成
- **完了条件**: 
  - すべての機能が正常に動作すること
  - ドキュメントが完成していること

---

## フェーズ完了条件

- [ ] 錬金スタイル管理UIが実装されていること
- [ ] ダッシュボード画面が実装されていること
- [ ] 統計情報表示が実装されていること
- [ ] 統計情報APIが実装されていること
- [ ] バリデーションが実装されていること
- [ ] エラーハンドリングが実装されていること
- [ ] すべてのテストがパスしていること
- [ ] パフォーマンス要件を満たしていること

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-01-XX | 1.0 | 初版作成 |

