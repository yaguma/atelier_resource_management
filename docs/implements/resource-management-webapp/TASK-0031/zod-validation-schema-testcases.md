# TASK-0031: Zodバリデーションスキーマ実装 - テストケース一覧

## 機能名
**Zodバリデーションスキーマ実装（Card エンティティ向け）**

---

## 開発言語・フレームワーク

- **プログラミング言語**: TypeScript
  - **言語選択の理由**: プロジェクト全体がTypeScriptで統一されており、型安全性を保証するため
  - **テストに適した機能**: 型推論とZodスキーマからの型生成により、テストコードも型安全に記述可能
- **テストフレームワーク**: Vitest + @vitest/ui
  - **フレームワーク選択の理由**: Vite環境との高い親和性、Jestと互換性のあるAPIを持ち、高速なテスト実行が可能
  - **テスト実行環境**: Node.js環境でユニットテストとして実行
- 🔵 この内容の信頼性レベル: **青信号** - package.jsonとプロジェクト構成から明確に決定

---

## テストケースサマリー

| カテゴリ | テストケース数 | 概要 |
|---------|--------------|------|
| 正常系 | 7 | 基本的なバリデーション成功ケース |
| 異常系 | 15 | エラーハンドリングとバリデーション失敗ケース |
| 境界値 | 13 | 最小値・最大値・境界条件のテスト |
| **合計** | **35** | **包括的なバリデーションテスト** |

---

## 1. 正常系テストケース（基本的な動作）

### TC-0031-001: 最小限の必須フィールドでバリデーション成功
- **テスト名**: 最小限の必須フィールドのみでcreateCardSchemaバリデーション成功
  - **何をテストするか**: 必須フィールド（name, description, cardType, attribute, stabilityValue, energyCost）のみでバリデーションが成功すること
  - **期待される動作**: オプショナルフィールドなしでも正常にバリデーションが通ること
- **入力値**:
  ```typescript
  {
    name: "火の結晶",
    description: "純粋な火の属性を持つ素材カード",
    cardType: "MATERIAL",
    attribute: { fire: 50 },
    stabilityValue: 0,
    energyCost: 1
  }
  ```
  - **入力データの意味**: 最もシンプルなカード作成データ。オプショナルフィールドを一切含まない
- **期待される結果**: バリデーション成功（エラーなし）
  - **期待結果の理由**: すべての必須フィールドが正しい型と範囲で提供されているため
- **テストの目的**: 必須フィールドの最小構成でバリデーションが機能することを確認
  - **確認ポイント**: オプショナルフィールドの省略が許可されること
- 🔵 **青信号**: 要件定義書のCreateCardRequest型定義から明確に導出

---

### TC-0031-002: すべてのフィールドを含むバリデーション成功
- **テスト名**: すべてのフィールド（オプショナル含む）でcreateCardSchemaバリデーション成功
  - **何をテストするか**: 必須・オプショナルすべてのフィールドを含むデータのバリデーション
  - **期待される動作**: フル機能のカード作成データが正常に検証されること
- **入力値**:
  ```typescript
  {
    name: "伝説の賢者の石",
    description: "全属性を統合する最高位のアーティファクト",
    cardType: "ARTIFACT",
    rarity: "LEGENDARY",
    attribute: { fire: 80, water: 70, earth: 60, wind: 90 },
    stabilityValue: 50,
    energyCost: 5,
    reactionEffect: "全属性値を2倍にする",
    imageUrl: "https://example.com/images/philosopher-stone.png",
    evolutionFromId: "123e4567-e89b-12d3-a456-426614174000"
  }
  ```
  - **入力データの意味**: すべてのフィールドを含む完全なカードデータ
- **期待される結果**: バリデーション成功
  - **期待結果の理由**: すべてのフィールドが正しい型・範囲・形式で提供されているため
- **テストの目的**: フル機能のバリデーションが正常動作することを確認
  - **確認ポイント**: 複数の属性値、URL、UUID形式が正しく検証されること
- 🔵 **青信号**: interfaces.tsのCard型定義とCreateCardRequest型から明確に導出

---

### TC-0031-003: オプショナルフィールドがnullでバリデーション成功
- **テスト名**: オプショナルフィールドに明示的にnullを設定してバリデーション成功
  - **何をテストするか**: nullable指定されたフィールドがnullでもバリデーションが成功すること
  - **期待される動作**: null許可フィールドが正しく動作すること
- **入力値**:
  ```typescript
  {
    name: "基本素材",
    description: "最も基本的な素材カード",
    cardType: "MATERIAL",
    attribute: { earth: 10 },
    stabilityValue: 0,
    energyCost: 0,
    rarity: null,
    reactionEffect: null,
    imageUrl: null,
    evolutionFromId: null
  }
  ```
  - **入力データの意味**: オプショナルフィールドを明示的にnullに設定したデータ
- **期待される結果**: バリデーション成功
  - **期待結果の理由**: rarity, reactionEffect, imageUrl, evolutionFromIdはnullable設計のため
- **テストの目的**: nullable制約が正しく機能することを確認
  - **確認ポイント**: null許可フィールドでエラーが発生しないこと
- 🔵 **青信号**: interfaces.tsのCreateCardRequest型定義から明確に導出

---

### TC-0031-004: updateCardSchemaで部分更新（1フィールドのみ）のバリデーション成功
- **テスト名**: updateCardSchemaでnameフィールドのみ更新する部分更新バリデーション成功
  - **何をテストするか**: updateCardSchemaがpartial型として動作し、1フィールドのみでバリデーション成功すること
  - **期待される動作**: すべてのフィールドがオプショナル化されていること
- **入力値**:
  ```typescript
  {
    name: "更新されたカード名"
  }
  ```
  - **入力データの意味**: 部分更新で名前のみを変更するケース
- **期待される結果**: バリデーション成功
  - **期待結果の理由**: updateCardSchemaはcreateCardSchema.partial()で生成され、すべてのフィールドがオプショナルのため
- **テストの目的**: 部分更新スキーマが正しく動作することを確認
  - **確認ポイント**: 1フィールドのみでもバリデーションが通ること
- 🔵 **青信号**: 要件定義書の「updateCardSchema: createCardSchemaのpartial版」から明確に導出

---

### TC-0031-005: CardType enumのすべての値でバリデーション成功
- **テスト名**: CardType enumの全6種類（MATERIAL, OPERATION, CATALYST, KNOWLEDGE, SPECIAL, ARTIFACT）でバリデーション成功
  - **何をテストするか**: すべての有効なCardType値がバリデーションを通過すること
  - **期待される動作**: 6種類すべてのカード系統が正しく認識されること
- **入力値**: 各enum値でテストケースを6回実行
  - **入力データの意味**: すべての有効なカード系統をカバー
- **期待される結果**: 各enum値でバリデーション成功
  - **期待結果の理由**: WRREQ-012で定義された6種類のカード系統すべてが有効なため
- **テストの目的**: Enum定義の網羅性確認
  - **確認ポイント**: すべてのenum値が受け入れられること
- 🔵 **青信号**: WRREQ-012とinterfaces.tsのCardType定義から明確に導出

---

### TC-0031-006: CardRarity enumのすべての値でバリデーション成功
- **テスト名**: CardRarity enumの全5種類（COMMON, UNCOMMON, RARE, EPIC, LEGENDARY）でバリデーション成功
  - **何をテストするか**: すべての有効なCardRarity値がバリデーションを通過すること
  - **期待される動作**: 5種類すべてのレア度が正しく認識されること
- **入力値**: 各enum値でテストケースを5回実行
  - **入力データの意味**: すべての有効なレア度をカバー
- **期待される結果**: 各enum値でバリデーション成功
  - **期待結果の理由**: interfaces.tsで定義された5種類のレア度すべてが有効なため
- **テストの目的**: Enum定義の網羅性確認
  - **確認ポイント**: すべてのenum値が受け入れられること
- 🔵 **青信号**: interfaces.tsのCardRarity定義から明確に導出

---

### TC-0031-007: 複数の属性値を持つattributeフィールドでバリデーション成功
- **テスト名**: attribute フィールドに複数の属性（fire, water, earth, wind等）を含むバリデーション成功
  - **何をテストするか**: Record<string, number>型のattributeが複数の属性を正しく受け入れること
  - **期待される動作**: 任意の属性名と数値のペアが受け入れられること
- **入力値**:
  ```typescript
  {
    attribute: {
      fire: 30,
      water: 40,
      earth: 20,
      wind: 10,
      light: 50,
      dark: 25
    }
  }
  ```
  - **入力データの意味**: 6種類の属性を持つ複雑なカード
- **期待される結果**: バリデーション成功
  - **期待結果の理由**: attributeはRecord<string, number>型で、任意の属性名を許可するため
- **テストの目的**: 柔軟な属性システムの動作確認
  - **確認ポイント**: 複数属性が正しく検証されること
- 🔵 **青信号**: interfaces.tsのAttributeValue型定義から明確に導出

---

## 2. 異常系テストケース（エラーハンドリング）

### TC-0031-101: 必須フィールド（name）未入力エラー
- **テスト名**: nameフィールドが空文字列の場合にバリデーションエラーが発生
  - **エラーケースの概要**: 必須フィールドの入力漏れ
  - **エラー処理の重要性**: カード名なしでの作成を防ぐため
- **入力値**:
  ```typescript
  {
    name: "",  // 空文字列
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **不正な理由**: nameは最小1文字必要
  - **実際の発生シナリオ**: ユーザーがカード名を入力せずにフォーム送信した場合
- **期待される結果**: バリデーションエラー「カード名は必須です」
  - **エラーメッセージの内容**: 日本語で分かりやすいメッセージ
  - **システムの安全性**: 不完全なデータがAPIに送信されるのを防ぐ
- **テストの目的**: 必須フィールドバリデーションの確認
  - **品質保証の観点**: データ整合性を保証
- 🔵 **青信号**: WRREQ-055とWRREQ-013から明確に導出

---

### TC-0031-102: 必須フィールド（description）未入力エラー
- **テスト名**: descriptionフィールドが空文字列の場合にバリデーションエラーが発生
  - **エラーケースの概要**: 説明フィールドの入力漏れ
  - **エラー処理の重要性**: カードの説明なしでの作成を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "",  // 空文字列
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **不正な理由**: descriptionは最小1文字必要
  - **実際の発生シナリオ**: ユーザーが説明を入力せずにフォーム送信した場合
- **期待される結果**: バリデーションエラー「説明は必須です」
  - **エラーメッセージの内容**: 日本語で分かりやすいメッセージ
  - **システムの安全性**: 説明のないカードの作成を防ぐ
- **テストの目的**: 必須フィールドバリデーションの確認
  - **品質保証の観点**: ユーザビリティ向上（説明のないカードを防ぐ）
- 🔵 **青信号**: WRREQ-055とWRREQ-013から明確に導出

---

### TC-0031-103: 文字数超過エラー（name: 101文字）
- **テスト名**: nameフィールドが100文字を超えた場合にバリデーションエラーが発生
  - **エラーケースの概要**: 文字数制限違反
  - **エラー処理の重要性**: データベース制約違反を事前に防ぐため
- **入力値**:
  ```typescript
  {
    name: "あ".repeat(101),  // 101文字
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **不正な理由**: nameの最大文字数は100文字
  - **実際の発生シナリオ**: ユーザーが長すぎるカード名を入力した場合
- **期待される結果**: バリデーションエラー「カード名は100文字以内で入力してください」
  - **エラーメッセージの内容**: 文字数制限を明示
  - **システムの安全性**: データベースエラーを事前に防ぐ
- **テストの目的**: 文字数制限バリデーションの確認
  - **品質保証の観点**: WREDGE-004の要件を満たす
- 🔵 **青信号**: WREDGE-004とinterfaces.tsから明確に導出

---

### TC-0031-104: 文字数超過エラー（description: 1001文字）
- **テスト名**: descriptionフィールドが1000文字を超えた場合にバリデーションエラーが発生
  - **エラーケースの概要**: 説明文の文字数制限違反
  - **エラー処理の重要性**: データベース制約違反を事前に防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "あ".repeat(1001),  // 1001文字
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **不正な理由**: descriptionの最大文字数は1000文字
  - **実際の発生シナリオ**: ユーザーが非常に長い説明を入力した場合
- **期待される結果**: バリデーションエラー「説明は1000文字以内で入力してください」
  - **エラーメッセージの内容**: 文字数制限を明示
  - **システムの安全性**: データベースエラーを事前に防ぐ
- **テストの目的**: 文字数制限バリデーションの確認
  - **品質保証の観点**: データ品質を保証
- 🔵 **青信号**: interfaces.tsのCard型定義から明確に導出

---

### TC-0031-105: 文字数超過エラー（reactionEffect: 501文字）
- **テスト名**: reactionEffectフィールドが500文字を超えた場合にバリデーションエラーが発生
  - **エラーケースの概要**: 反応効果の文字数制限違反
  - **エラー処理の重要性**: データベース制約違反を事前に防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0,
    reactionEffect: "あ".repeat(501)  // 501文字
  }
  ```
  - **不正な理由**: reactionEffectの最大文字数は500文字
  - **実際の発生シナリオ**: ユーザーが非常に詳細な反応効果を入力した場合
- **期待される結果**: バリデーションエラー「反応効果は500文字以内で入力してください」
  - **エラーメッセージの内容**: 文字数制限を明示
  - **システムの安全性**: データベースエラーを事前に防ぐ
- **テストの目的**: オプショナルフィールドの文字数制限確認
  - **品質保証の観点**: データ品質を保証
- 🔵 **青信号**: WRREQ-013とinterfaces.tsから明確に導出

---

### TC-0031-106: 数値範囲外エラー（energyCost: -1）
- **テスト名**: energyCostがマイナス値の場合にバリデーションエラーが発生
  - **エラーケースの概要**: エネルギーコストの範囲制約違反
  - **エラー処理の重要性**: ゲームバランスを崩す不正な値を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: -1  // 範囲外
  }
  ```
  - **不正な理由**: energyCostは0〜5の範囲
  - **実際の発生シナリオ**: ユーザーがマイナス値を誤入力した場合
- **期待される結果**: バリデーションエラー「エネルギーコストは0〜5の範囲で入力してください」
  - **エラーメッセージの内容**: 有効範囲を明示
  - **システムの安全性**: ゲームバランスを保護
- **テストの目的**: 数値範囲バリデーションの確認
  - **品質保証の観点**: WREDGE-005の要件を満たす
- 🔵 **青信号**: WRREQ-014とWREDGE-005から明確に導出

---

### TC-0031-107: 数値範囲外エラー（energyCost: 6）
- **テスト名**: energyCostが最大値を超えた場合にバリデーションエラーが発生
  - **エラーケースの概要**: エネルギーコストの上限超過
  - **エラー処理の重要性**: ゲームバランスを崩す過大な値を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 6  // 範囲外
  }
  ```
  - **不正な理由**: energyCostの最大値は5
  - **実際の発生シナリオ**: ユーザーが範囲外の値を入力した場合
- **期待される結果**: バリデーションエラー「エネルギーコストは0〜5の範囲で入力してください」
  - **エラーメッセージの内容**: 有効範囲を明示
  - **システムの安全性**: ゲームバランスを保護
- **テストの目的**: 上限値バリデーションの確認
  - **品質保証の観点**: WRREQ-014の要件を満たす
- 🔵 **青信号**: WRREQ-014から明確に導出

---

### TC-0031-108: 数値範囲外エラー（stabilityValue: 101）
- **テスト名**: stabilityValueが最大値を超えた場合にバリデーションエラーが発生
  - **エラーケースの概要**: 安定値の上限超過
  - **エラー処理の重要性**: ゲームバランスを崩す過大な値を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 101,  // 範囲外
    energyCost: 0
  }
  ```
  - **不正な理由**: stabilityValueは-100〜100の範囲
  - **実際の発生シナリオ**: ユーザーが範囲外の値を入力した場合
- **期待される結果**: バリデーションエラー「安定値は-100〜100の範囲で入力してください」
  - **エラーメッセージの内容**: 有効範囲を明示
  - **システムの安全性**: ゲームバランスを保護
- **テストの目的**: 安定値バリデーションの確認
  - **品質保証の観点**: WRREQ-013の要件を満たす
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-109: 数値範囲外エラー（stabilityValue: -101）
- **テスト名**: stabilityValueが最小値を下回った場合にバリデーションエラーが発生
  - **エラーケースの概要**: 安定値の下限超過
  - **エラー処理の重要性**: ゲームバランスを崩す過小な値を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: -101,  // 範囲外
    energyCost: 0
  }
  ```
  - **不正な理由**: stabilityValueの最小値は-100
  - **実際の発生シナリオ**: ユーザーがマイナス方向に範囲外の値を入力した場合
- **期待される結果**: バリデーションエラー「安定値は-100〜100の範囲で入力してください」
  - **エラーメッセージの内容**: 有効範囲を明示
  - **システムの安全性**: ゲームバランスを保護
- **テストの目的**: 下限値バリデーションの確認
  - **品質保証の観点**: WRREQ-013の要件を満たす
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-110: 属性値範囲外エラー（attribute値: 101）
- **テスト名**: attributeの値が100を超えた場合にバリデーションエラーが発生
  - **エラーケースの概要**: 属性値の上限超過
  - **エラー処理の重要性**: ゲームバランスを崩す過大な属性値を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 101 },  // 範囲外
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **不正な理由**: 各属性値は0〜100の範囲
  - **実際の発生シナリオ**: ユーザーが範囲外の属性値を入力した場合
- **期待される結果**: バリデーションエラー「属性値は0〜100の範囲で入力してください」
  - **エラーメッセージの内容**: 有効範囲を明示
  - **システムの安全性**: ゲームバランスを保護
- **テストの目的**: 属性値バリデーションの確認
  - **品質保証の観点**: WRREQ-013の要件を満たす
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-111: 属性値範囲外エラー（attribute値: -1）
- **テスト名**: attributeの値がマイナス値の場合にバリデーションエラーが発生
  - **エラーケースの概要**: 属性値の下限超過
  - **エラー処理の重要性**: 不正なマイナス属性値を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: -1 },  // 範囲外
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **不正な理由**: 各属性値の最小値は0
  - **実際の発生シナリオ**: ユーザーがマイナス値を誤入力した場合
- **期待される結果**: バリデーションエラー「属性値は0〜100の範囲で入力してください」
  - **エラーメッセージの内容**: 有効範囲を明示
  - **システムの安全性**: データ整合性を保証
- **テストの目的**: 属性値下限バリデーションの確認
  - **品質保証の観点**: WRREQ-013の要件を満たす
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-112: Enum型不一致エラー（cardType: 無効な値）
- **テスト名**: cardTypeに定義外の値を設定した場合にバリデーションエラーが発生
  - **エラーケースの概要**: カード系統のenum値不一致
  - **エラー処理の重要性**: 未定義のカード系統の作成を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "INVALID_TYPE",  // 無効な値
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **不正な理由**: cardTypeはMATERIAL, OPERATION, CATALYST, KNOWLEDGE, SPECIAL, ARTIFACTのいずれかでなければならない
  - **実際の発生シナリオ**: API呼び出し時に不正な値が送信された場合
- **期待される結果**: バリデーションエラー「無効なカード系統です」
  - **エラーメッセージの内容**: enum値が不正であることを明示
  - **システムの安全性**: 未定義のカード系統を防ぐ
- **テストの目的**: enum型バリデーションの確認
  - **品質保証の観点**: WRREQ-012の要件を満たす
- 🔵 **青信号**: WRREQ-012とinterfaces.tsから明確に導出

---

### TC-0031-113: Enum型不一致エラー（rarity: 無効な値）
- **テスト名**: rarityに定義外の値を設定した場合にバリデーションエラーが発生
  - **エラーケースの概要**: レア度のenum値不一致
  - **エラー処理の重要性**: 未定義のレア度の設定を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0,
    rarity: "INVALID_RARITY"  // 無効な値
  }
  ```
  - **不正な理由**: rarityはCOMMON, UNCOMMON, RARE, EPIC, LEGENDARYのいずれかまたはnullでなければならない
  - **実際の発生シナリオ**: API呼び出し時に不正なレア度が送信された場合
- **期待される結果**: バリデーションエラー「無効なレア度です」
  - **エラーメッセージの内容**: enum値が不正であることを明示
  - **システムの安全性**: 未定義のレア度を防ぐ
- **テストの目的**: オプショナルenum型バリデーションの確認
  - **品質保証の観点**: データ整合性を保証
- 🔵 **青信号**: interfaces.tsのCardRarity定義から明確に導出

---

### TC-0031-114: URL形式不正エラー
- **テスト名**: imageUrlに不正なURL形式を設定した場合にバリデーションエラーが発生
  - **エラーケースの概要**: URL形式の不一致
  - **エラー処理の重要性**: 無効な画像URLの保存を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0,
    imageUrl: "not-a-valid-url"  // URL形式不正
  }
  ```
  - **不正な理由**: imageUrlは有効なURL形式でなければならない
  - **実際の発生シナリオ**: ユーザーが無効なURLを入力した場合
- **期待される結果**: バリデーションエラー「正しいURL形式で入力してください」
  - **エラーメッセージの内容**: URL形式が不正であることを明示
  - **システムの安全性**: 無効な画像URLを防ぐ
- **テストの目的**: URL形式バリデーションの確認
  - **品質保証の観点**: データ品質を保証
- 🟡 **黄信号**: interfaces.tsのimageUrl型定義から推測（Zodでz.string().url()を使用すべき）

---

### TC-0031-115: UUID形式不正エラー
- **テスト名**: evolutionFromIdに不正なUUID形式を設定した場合にバリデーションエラーが発生
  - **エラーケースの概要**: UUID形式の不一致
  - **エラー処理の重要性**: 無効なカードIDの参照を防ぐため
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0,
    evolutionFromId: "not-a-uuid"  // UUID形式不正
  }
  ```
  - **不正な理由**: evolutionFromIdは有効なUUID v4形式でなければならない
  - **実際の発生シナリオ**: API呼び出し時に不正なIDが送信された場合
- **期待される結果**: バリデーションエラー「正しいUUID形式で入力してください」
  - **エラーメッセージの内容**: UUID形式が不正であることを明示
  - **システムの安全性**: 無効なカード参照を防ぐ
- **テストの目的**: UUID形式バリデーションの確認
  - **品質保証の観点**: データ整合性を保証
- 🟡 **黄信号**: interfaces.tsのevolutionFromId型定義から推測（Zodでz.string().uuid()を使用すべき）

---

## 3. 境界値テストケース（最小値、最大値、null等）

### TC-0031-201: 文字数境界値（name: 1文字）
- **テスト名**: nameフィールドが最小文字数（1文字）でバリデーション成功
  - **境界値の意味**: 最小文字数の境界
  - **境界値での動作保証**: 1文字でも有効なカード名として扱われること
- **入力値**:
  ```typescript
  {
    name: "火",  // 1文字（最小値）
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: nameの最小文字数は1文字
  - **実際の使用場面**: 短いカード名の作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 1文字でもエラーが発生しないこと
  - **一貫した動作**: 空文字列はエラー、1文字は成功
- **テストの目的**: 最小文字数境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-202: 文字数境界値（name: 100文字）
- **テスト名**: nameフィールドが最大文字数（100文字）でバリデーション成功
  - **境界値の意味**: 最大文字数の境界
  - **境界値での動作保証**: ちょうど100文字でも有効であること
- **入力値**:
  ```typescript
  {
    name: "あ".repeat(100),  // 100文字（最大値）
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: nameの最大文字数は100文字
  - **実際の使用場面**: 長いカード名の作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: ちょうど100文字でエラーが発生しないこと
  - **一貫した動作**: 100文字は成功、101文字はエラー
- **テストの目的**: 最大文字数境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WREDGE-004から明確に導出

---

### TC-0031-203: 文字数境界値（description: 1文字）
- **テスト名**: descriptionフィールドが最小文字数（1文字）でバリデーション成功
  - **境界値の意味**: 説明の最小文字数境界
  - **境界値での動作保証**: 1文字の説明でも有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説",  // 1文字（最小値）
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: descriptionの最小文字数は1文字
  - **実際の使用場面**: 簡潔な説明の作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 1文字でもエラーが発生しないこと
  - **一貫した動作**: 空文字列はエラー、1文字は成功
- **テストの目的**: 最小文字数境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-204: 文字数境界値（description: 1000文字）
- **テスト名**: descriptionフィールドが最大文字数（1000文字）でバリデーション成功
  - **境界値の意味**: 説明の最大文字数境界
  - **境界値での動作保証**: ちょうど1000文字でも有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "あ".repeat(1000),  // 1000文字（最大値）
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: descriptionの最大文字数は1000文字
  - **実際の使用場面**: 非常に詳細な説明の作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: ちょうど1000文字でエラーが発生しないこと
  - **一貫した動作**: 1000文字は成功、1001文字はエラー
- **テストの目的**: 最大文字数境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: interfaces.tsから明確に導出

---

### TC-0031-205: 文字数境界値（reactionEffect: 500文字）
- **テスト名**: reactionEffectフィールドが最大文字数（500文字）でバリデーション成功
  - **境界値の意味**: 反応効果の最大文字数境界
  - **境界値での動作保証**: ちょうど500文字でも有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0,
    reactionEffect: "あ".repeat(500)  // 500文字（最大値）
  }
  ```
  - **境界値選択の根拠**: reactionEffectの最大文字数は500文字
  - **実際の使用場面**: 詳細な反応効果の記述
- **期待される結果**: バリデーション成功
  - **境界での正確性**: ちょうど500文字でエラーが発生しないこと
  - **一貫した動作**: 500文字は成功、501文字はエラー
- **テストの目的**: オプショナルフィールドの最大文字数境界確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-206: 数値境界値（energyCost: 0）
- **テスト名**: energyCostが最小値（0）でバリデーション成功
  - **境界値の意味**: エネルギーコストの下限境界
  - **境界値での動作保証**: コスト0のカードが有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 0  // 最小値
  }
  ```
  - **境界値選択の根拠**: energyCostの最小値は0
  - **実際の使用場面**: 無料で使用できるカードの作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 0でエラーが発生しないこと
  - **一貫した動作**: 0は成功、-1はエラー
- **テストの目的**: 最小値境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-014から明確に導出

---

### TC-0031-207: 数値境界値（energyCost: 5）
- **テスト名**: energyCostが最大値（5）でバリデーション成功
  - **境界値の意味**: エネルギーコストの上限境界
  - **境界値での動作保証**: 最大コストのカードが有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,
    energyCost: 5  // 最大値
  }
  ```
  - **境界値選択の根拠**: energyCostの最大値は5
  - **実際の使用場面**: 最高コストのカードの作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 5でエラーが発生しないこと
  - **一貫した動作**: 5は成功、6はエラー
- **テストの目的**: 最大値境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-014から明確に導出

---

### TC-0031-208: 数値境界値（stabilityValue: -100）
- **テスト名**: stabilityValueが最小値（-100）でバリデーション成功
  - **境界値の意味**: 安定値の下限境界
  - **境界値での動作保証**: 最低安定値のカードが有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: -100,  // 最小値
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: stabilityValueの最小値は-100
  - **実際の使用場面**: 極めて不安定なカードの作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: -100でエラーが発生しないこと
  - **一貫した動作**: -100は成功、-101はエラー
- **テストの目的**: マイナス値境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-209: 数値境界値（stabilityValue: 100）
- **テスト名**: stabilityValueが最大値（100）でバリデーション成功
  - **境界値の意味**: 安定値の上限境界
  - **境界値での動作保証**: 最高安定値のカードが有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 100,  // 最大値
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: stabilityValueの最大値は100
  - **実際の使用場面**: 極めて安定したカードの作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 100でエラーが発生しないこと
  - **一貫した動作**: 100は成功、101はエラー
- **テストの目的**: 最大値境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-210: 数値境界値（stabilityValue: 0）
- **テスト名**: stabilityValueが中央値（0）でバリデーション成功
  - **境界値の意味**: 安定値のニュートラル値
  - **境界値での動作保証**: 中立的な安定値が有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 10 },
    stabilityValue: 0,  // 中央値
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: 0は正負の境界値
  - **実際の使用場面**: 中立的な安定値を持つカードの作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 0が正しく受け入れられること
  - **一貫した動作**: マイナス・ゼロ・プラスすべてで動作すること
- **テストの目的**: ゼロ値の動作確認
  - **堅牢性の確認**: ゼロが正しく扱われること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-211: 数値境界値（attribute値: 0）
- **テスト名**: attributeの値が最小値（0）でバリデーション成功
  - **境界値の意味**: 属性値の下限境界
  - **境界値での動作保証**: 属性値0が有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 0 },  // 最小値
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: 各属性値の最小値は0
  - **実際の使用場面**: 特定属性を持たないカードの作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 0でエラーが発生しないこと
  - **一貫した動作**: 0は成功、-1はエラー
- **テストの目的**: 属性値最小境界の確認
  - **堅牢性の確認**: ゼロ属性が正しく扱われること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-212: 数値境界値（attribute値: 100）
- **テスト名**: attributeの値が最大値（100）でバリデーション成功
  - **境界値の意味**: 属性値の上限境界
  - **境界値での動作保証**: 最大属性値が有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: { fire: 100 },  // 最大値
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: 各属性値の最大値は100
  - **実際の使用場面**: 最大属性を持つカードの作成
- **期待される結果**: バリデーション成功
  - **境界での正確性**: 100でエラーが発生しないこと
  - **一貫した動作**: 100は成功、101はエラー
- **テストの目的**: 属性値最大境界の確認
  - **堅牢性の確認**: 境界値で正常動作すること
- 🔵 **青信号**: WRREQ-013から明確に導出

---

### TC-0031-213: 空オブジェクト境界値（attribute: {}）
- **テスト名**: attributeが空オブジェクト（{}）でバリデーション成功
  - **境界値の意味**: 属性を持たないカードの境界
  - **境界値での動作保証**: 属性なしのカードが有効であること
- **入力値**:
  ```typescript
  {
    name: "カード名",
    description: "説明",
    cardType: "MATERIAL",
    attribute: {},  // 空オブジェクト
    stabilityValue: 0,
    energyCost: 0
  }
  ```
  - **境界値選択の根拠**: attributeはRecord<string, number>型で空も許容される可能性
  - **実際の使用場面**: 属性を持たない特殊なカードの作成
- **期待される結果**: バリデーション成功（または設計次第でエラー）
  - **境界での正確性**: 空オブジェクトの扱いが明確であること
  - **一貫した動作**: attributeの必須性が正しく動作すること
- **テストの目的**: 空オブジェクトの動作確認
  - **堅牢性の確認**: 極端なケースでの動作を確認
- 🟡 **黄信号**: 要件定義書に空オブジェクトの扱いが明記されていないため推測

---

## テストケース実装時の日本語コメント指針

各テストケース実装時には、以下の形式でコメントを記載してください：

### テストケース開始時のコメント

```typescript
// 【テスト目的】: [このテストで何を確認するかを日本語で明記]
// 【テスト内容】: [具体的にどのような処理をテストするかを説明]
// 【期待される動作】: [正常に動作した場合の結果を説明]
// 🔵🟡🔴 この内容の信頼性レベルを記載
```

### Given（準備フェーズ）のコメント

```typescript
// 【テストデータ準備】: [なぜこのデータを用意するかの理由]
// 【初期条件設定】: [テスト実行前の状態を説明]
// 【前提条件確認】: [テスト実行に必要な前提条件を明記]
```

### When（実行フェーズ）のコメント

```typescript
// 【実際の処理実行】: [どの機能/メソッドを呼び出すかを説明]
// 【処理内容】: [実行される処理の内容を日本語で説明]
// 【実行タイミング】: [なぜこのタイミングで実行するかを説明]
```

### Then（検証フェーズ）のコメント

```typescript
// 【結果検証】: [何を検証するかを具体的に説明]
// 【期待値確認】: [期待される結果とその理由を説明]
// 【品質保証】: [この検証がシステム品質にどう貢献するかを説明]
```

### 各expectステートメントのコメント

```typescript
// 【検証項目】: [この検証で確認している具体的な項目]
// 🔵🟡🔴 この内容の信頼性レベルを記載
expect(result.success).toBe(true); // 【確認内容】: バリデーション成功フラグの確認
```

### セットアップ・クリーンアップのコメント

```typescript
beforeEach(() => {
  // 【テスト前準備】: [各テスト実行前に行う準備作業の説明]
  // 【環境初期化】: [テスト環境をクリーンな状態にする理由と方法]
});

afterEach(() => {
  // 【テスト後処理】: [各テスト実行後に行うクリーンアップ作業の説明]
  // 【状態復元】: [次のテストに影響しないよう状態を復元する理由]
});
```

---

## テスト実装例

```typescript
import { describe, it, expect } from 'vitest';
import { createCardSchema, updateCardSchema } from '@/types/card';

describe('createCardSchema - 正常系テスト', () => {
  it('TC-0031-001: 最小限の必須フィールドでバリデーション成功', () => {
    // 【テスト目的】: 必須フィールドのみでバリデーションが成功することを確認
    // 【テスト内容】: name, description, cardType, attribute, stabilityValue, energyCost のみを含むデータでバリデーション
    // 【期待される動作】: オプショナルフィールドなしでもバリデーションが通ること
    // 🔵 青信号: 要件定義書から明確に導出

    // 【テストデータ準備】: 最小限の必須フィールドのみを含むカードデータを用意
    // 【初期条件設定】: オプショナルフィールドを一切含まない
    // 【前提条件確認】: すべての必須フィールドが正しい型と範囲であること
    const input = {
      name: "火の結晶",
      description: "純粋な火の属性を持つ素材カード",
      cardType: "MATERIAL" as const,
      attribute: { fire: 50 },
      stabilityValue: 0,
      energyCost: 1
    };

    // 【実際の処理実行】: createCardSchemaのバリデーションを実行
    // 【処理内容】: Zodスキーマによる型チェックとバリデーションルール適用
    // 【実行タイミング】: テストデータ準備後、即座にバリデーション実行
    const result = createCardSchema.safeParse(input);

    // 【結果検証】: バリデーション成功を確認
    // 【期待値確認】: successがtrueであること
    // 【品質保証】: 必須フィールドのみでも正常動作することを保証
    // 【検証項目】: バリデーション成功フラグ
    // 🔵 青信号
    expect(result.success).toBe(true);
  });
});
```

---

## 品質判定

### ✅ 高品質

以下の基準をすべて満たしています：

- **テストケース分類**: 正常系（7）・異常系（15）・境界値（13）が網羅されている
- **期待値定義**: 各テストケースの期待値が明確に定義されている
- **技術選択**: TypeScript + Vitest + Zod が確定している
- **実装可能性**: 現在の技術スタックで実現可能である
- **信頼性レベル**:
  - 🔵 青信号（要件定義書から明確に導出）: 32ケース
  - 🟡 黄信号（妥当な推測）: 3ケース（URL形式、UUID形式、空オブジェクト）
  - 🔴 赤信号（推測）: 0ケース

---

## 次のステップ

**次のお勧めステップ**: `/tdd-red` でRedフェーズ（失敗テスト作成）を開始します。

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-11-09 | 1.0 | 初版作成。TASK-0031のテストケース一覧を作成（正常系7件、異常系15件、境界値13件、合計35件） |
