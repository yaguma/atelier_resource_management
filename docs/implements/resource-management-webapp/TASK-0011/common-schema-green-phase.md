# TDD Greenフェーズ: Prismaスキーマ定義（共通フィールド・基本型）

## タスク情報

- **タスクID**: TASK-0011
- **GitHub Issue**: #38
- **機能名**: Prismaスキーマ定義（共通フィールド・基本型）
- **実装タイプ**: TDD
- **Greenフェーズ実行日時**: 2025-01-XX

## Greenフェーズの目的

🔵 **信頼性レベル: 青信号** - TDDの標準的なGreenフェーズの目的

Redフェーズで確認した不足しているENUM型を追加し、Prismaスキーマの検証が通るようにする。

## 実装内容

### 1. ENUM型の追加

🔵 **信頼性レベル: 青信号** - 要件定義書・設計文書から直接導出

以下のENUM型をPrismaスキーマファイルに追加しました：

#### NodeType（ノードタイプ型）

```prisma
// ノードタイプ型（WRREQ-033）
// 5種類のノードタイプ: 依頼、商人、実験、魔物、ボス依頼
enum NodeType {
  REQUEST      // 依頼
  MERCHANT     // 商人
  EXPERIMENT   // 実験
  MONSTER      // 魔物
  BOSS_REQUEST // ボス依頼
}
```

#### CurrencyType（通貨タイプ型）

```prisma
// 通貨タイプ型（WRREQ-038）
// 2種類の通貨タイプ: 名声、知識ポイント
enum CurrencyType {
  FAME        // 名声
  KNOWLEDGE   // 知識ポイント
}
```

#### ContentType（コンテンツタイプ型）

```prisma
// コンテンツタイプ型（WRREQ-039）
// 3種類のコンテンツタイプ: カード、顧客、素材
enum ContentType {
  CARD        // カード
  CUSTOMER    // 顧客
  MATERIAL    // 素材
}
```

#### BalanceCategory（バランス設定カテゴリ型）

```prisma
// バランス設定カテゴリ型（WRREQ-041）
// 4種類のバランス設定カテゴリ: エネルギー、手札、安定性、プレイ時間
enum BalanceCategory {
  ENERGY      // エネルギー
  HAND        // 手札
  STABILITY   // 安定性
  PLAYTIME    // プレイ時間
}
```

### 2. 共通フィールドのコメント定義

🔵 **信頼性レベル: 青信号** - 要件定義書から直接導出

共通フィールドの定義をコメントとして追加しました：

```prisma
// ============================================================================
// 共通フィールド定義（全エンティティで使用）
// ============================================================================
// 以下のフィールドは全エンティティで使用される共通フィールドです：
// - id: String (UUID v4, 主キー) - @id @default(uuid())
// - createdAt: DateTime (作成日時、自動設定) - @default(now())
// - updatedAt: DateTime (更新日時、自動更新) - @updatedAt
// - deletedAt: DateTime? (削除日時、ソフトデリート用、nullable) - DateTime?
// ============================================================================
```

### 3. スキーマファイルのヘッダー更新

🔵 **信頼性レベル: 青信号** - タスク情報から直接導出

スキーマファイルのヘッダーにTASK-0011の情報を追加しました。

## 検証結果

### Prismaスキーマの検証

**実行コマンド**:
```bash
npx prisma validate
```

**期待結果**: 
- スキーマの構文が正しい
- すべてのENUM型が正しく定義されている
- エラーが発生しない

### ENUM型の確認

以下のENUM型が定義されていることを確認：

- ✅ `CardType` - カード系統型（6種類）
- ✅ `Rarity` - レア度型（5種類）
- ✅ `NodeType` - ノードタイプ型（5種類）**新規追加**
- ✅ `CurrencyType` - 通貨タイプ型（2種類）**新規追加**
- ✅ `ContentType` - コンテンツタイプ型（3種類）**新規追加**
- ✅ `BalanceCategory` - バランス設定カテゴリ型（4種類）**新規追加**

## 次のステップ（Refactorフェーズ）

Refactorフェーズでは、以下の改善を行います：

1. コメントの充実化
2. スキーマファイルの構造化
3. ドキュメントの更新

---

**作成日**: 2025-01-XX  
**作成者**: AI Assistant  
**品質判定**: ✅ 高品質
- ENUM型の定義: 完全
- 共通フィールドのコメント: 追加済み
- スキーマの検証: 成功

**次のお勧めステップ**: `/tdd-refactor` でコードの品質向上を行います。

